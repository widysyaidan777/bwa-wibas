<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Peta Topologi – BWA WiBAS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background:#020617;
  color:white;
}

/* HEADER */
header {
  padding: 14px 20px;
  font-size: 22px;
  font-weight: bold;
  background: linear-gradient(90deg,#0f172a,#020617);
}

/* SIDEBAR */
#sidebar {
  position: fixed;
  top: 60px;
  left: 0;
  width: 220px;
  height: calc(100vh - 60px);
  background: #020617;
  padding: 12px;
  box-sizing: border-box;
}

.node-btn {
  width:100%;
  padding:8px;
  margin:4px 0;
  border:none;
  border-radius:4px;
  background:#2563eb;
  color:white;
  cursor:pointer;
}
.node-btn.gray {background:#334155;}
.node-btn.red {background:#dc2626;}

/* MAIN AREA */
#main {
  margin-left:220px;
  height: calc(100vh - 60px);
  display: flex;
  flex-direction: column;
}

/* MAP */
#map {
  flex: 1;
}

/* TOGGLE ARROW */
#toggle-arrow {
  text-align:center;
  background:#020617;
  cursor:pointer;
  padding:6px;
  border-top:1px solid #334155;
}
#toggle-arrow:hover {background:#0f172a;}

/* NODE TABLE */
#node-section {
  max-height: 260px;
  overflow-y: auto;
  background:#1e293b;
  padding:10px;
  transition: max-height 0.3s ease;
}
#node-section.hidden {
  max-height:0;
  padding:0;
  overflow:hidden;
}

/* TABLE */
table {
  width:100%;
  border-collapse: collapse;
  font-size:13px;
}
th,td {
  border-bottom:1px solid #334155;
  padding:6px;
  text-align:left;
}
th {background:#020617;}

.status-up {color:#22c55e;}
.status-down {color:#ef4444;}
</style>
</head>

<body>

<header>Peta Topologi – BWA WiBAS</header>

<!-- SIDEBAR -->
<div id="sidebar">
  <h4>Menu</h4>
  <button class="node-btn" onclick="showAll()">All</button>
  <button class="node-btn gray" onclick="filter('CJDA')">CJDA</button>
  <button class="node-btn gray" onclick="filter('WKA')">WKA</button>
  <button class="node-btn gray" onclick="filter('BNA')">BNA</button>

  <hr style="border:1px solid #334155">

  <h4>Ruler</h4>
  <button class="node-btn">Aktifkan Ruler</button>
  <button class="node-btn red">Reset Ruler</button>

  <hr style="border:1px solid #334155">

  <button class="node-btn gray" onclick="history.back()">⬅ Kembali</button>
</div>

<!-- MAIN -->
<div id="main">
  <div id="map"></div>

  <!-- TOGGLE -->
  <div id="toggle-arrow" onclick="toggleTable()">▲ / ▼</div>

  <!-- NODE TABLE -->
  <div id="node-section">
    <table>
      <thead>
        <tr>
          <th>Node</th>
          <th>Region</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody id="node-table"></tbody>
    </table>
  </div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
const map = L.map('map').setView([-7.2,110.3],7);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

const nodes = [];

/* generate 70 node */
nodes.push({name:'CJDA',region:'CJDA'});
nodes.push({name:'WKA',region:'WKA'});
nodes.push({name:'BNA',region:'BNA'});

for(let i=1;i<=60;i++){
  nodes.push({name:'BNA-'+i,region:'BNA'});
}

/* random position & status */
nodes.forEach(n=>{
  n.lat = -6.5 + Math.random();
  n.lng = 106 + Math.random()*4;
  n.status = Math.random()>0.2?'UP':'DOWN';
  n.marker = L.circleMarker([n.lat,n.lng],{
    radius:6,
    color:n.status==='UP'?'blue':'red'
  }).addTo(map).bindPopup(n.name);
});

function renderTable(list){
  const tbody = document.getElementById('node-table');
  tbody.innerHTML='';
  list.forEach(n=>{
    tbody.innerHTML+=`
      <tr>
        <td>${n.name}</td>
        <td>${n.region}</td>
        <td class="${n.status==='UP'?'status-up':'status-down'}">${n.status}</td>
      </tr>`;
  });
}

function showAll(){
  renderTable(nodes);
  nodes.forEach(n=>n.marker.addTo(map));
}

function filter(region){
  renderTable(nodes.filter(n=>n.region===region));
  nodes.forEach(n=>{
    if(n.region===region) n.marker.addTo(map);
    else map.removeLayer(n.marker);
  });
}

function toggleTable(){
  document.getElementById('node-section').classList.toggle('hidden');
}

showAll();
</script>

</body>
</html>
