import React, { useState } from "react";
import Papa from "papaparse";

export default function BwaWibasWebsite() {
  const [data, setData] = useState([]);
  const [search, setSearch] = useState("");

  const handleFileUpload = (e) => {
    const file = e.target.files[0];
    if (!file) return;

    Papa.parse(file, {
      header: true,
      skipEmptyLines: true,
      complete: (results) => {
        setData(results.data);
      },
    });
  };

  const filteredData = data.filter((row) =>
    Object.values(row).some((value) =>
      String(value).toLowerCase().includes(search.toLowerCase())
    )
  );

  return (
    <div className="min-h-screen bg-gray-50 p-8">
      <div className="max-w-6xl mx-auto space-y-10">
        {/* Header */}
        <header className="space-y-4">
          <h1 className="text-3xl font-bold">BWA WiBAS</h1>
          <p className="text-gray-600">
            Broadband Wireless Access â€“ Wireless Broadband Access System
          </p>
        </header>

        {/* Upload CSV */}
        <section className="bg-white rounded-2xl shadow p-6 space-y-4">
          <h2 className="text-xl font-semibold">Data BWA WiBAS</h2>
          <input
            type="file"
            accept=".csv"
            onChange={handleFileUpload}
            className="block"
          />

          {data.length > 0 && (
            <>
              <input
                type="text"
                placeholder="Search data..."
                value={search}
                onChange={(e) => setSearch(e.target.value)}
                className="border rounded px-3 py-2 w-full"
              />

              <div className="overflow-auto max-h-[400px]">
                <table className="min-w-full border text-sm">
                  <thead className="bg-gray-100 sticky top-0">
                    <tr>
                      {Object.keys(data[0]).map((key) => (
                        <th
                          key={key}
                          className="border px-3 py-2 text-left"
                        >
                          {key}
                        </th>
                      ))}
                    </tr>
                  </thead>
                  <tbody>
                    {filteredData.map((row, i) => (
                      <tr key={i} className="hover:bg-gray-50">
                        {Object.values(row).map((val, j) => (
                          <td key={j} className="border px-3 py-2">
                            {val}
                          </td>
                        ))}
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </>
          )}
        </section>
      </div>
    </div>
  );
}
